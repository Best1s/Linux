####UDPflood攻击原理

利用大量UDP小包冲击DNS服务器或Radius认证服务器、流媒体视频服务器。在UDPFLOOD攻击中，攻击者可发送大量伪造源IP地址的小UDP包。但是，由于UDP协议是无连接性的，所以只要开了一个UDP的端口提供相关服务的话，那么就可针对相关的服务进行攻击。
####UDPflood主要防护
- 判断包大小，如果是大包攻击则使用防止UDP碎片方法：根据攻击包大小设定包碎片重组大小，通常不小于1500。在极端情况下，可以考虑丢弃所有UDP碎片。

- 攻击端口为业务端口：根据该业务UDP最大包长设置UDP最大包大小以过滤异常流量。

- 攻击端口为非业务端口：一个是丢弃所有UDP包，可能会误伤正常业务；一个是建立UDP连接规则，要求所有去往该端口的UDP包，必须首先与TCP端口建立TCP连接。不过这种方法需要很专业的防火墙或其他防护设备支持。

UDP攻击是一种消耗对方资源，同时也消耗攻击者本身的资源的攻击方式。现在纯粹的UDP流量攻击比较少见了，取而代之的是UDP协议承载的DNS Query Flood攻击。
####UDP DNS Query Flood攻击原理
攻击者操纵大量傀儡机器向被攻击的服务器发送大量随机生成的域名解析请求，被攻击的DNS 服务器在接收到域名解析请求的时候首先会在服务器上查找是否有对应的缓存，如果查找不到并且该域名无法直接由服务器解析的时候，DNS 服务器会向其上层DNS服务器递归查询域名信息。域名解析的过程给服务器带来了很大的负载，每秒钟域名解析请求超过一定的数量就会造成DNS服务器解析域名超时。为了防止基于ACL的过滤，必须提高数据包的随机性。常用的做法是UDP层随机伪造源IP地址、随机伪造源端口等参数。在DNS协议层，随机伪造查询ID以及待解析域名。随机伪造待解析域名除了防止过滤外，还可以降低命中DNS缓存的可能性，尽可能多地消耗DNS服务器的CPU资源。

根据微软的统计数据，一台DNS服务器所能承受的动态域名查询的上限是每秒钟9000个请求。而我们知道，在一台P3的PC机上可以轻易地构造出每秒钟几万个域名解析请求，足以使一台硬件配置极高的DNS服务器瘫痪，由此可见DNS 服务器的脆弱性。同时需要注意的是，蠕虫扩散也会带来大量的域名解析请求。

####UDP DNS Query Flood防范
- 在UDP Flood的基础上对 UDP DNS Query Flood 攻击进行防护

- 根据域名 IP 自学习结果主动回应，减轻服务器负载（使用 DNS Cache）

- 对突然发起大量频度较低的域名解析请求的源 IP 地址进行带宽限制

- 在攻击发生时降低很少发起域名解析请求的源 IP 地址的优先级

- 限制每个源 IP 地址每秒的域名解析请求次数
